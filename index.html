<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãã†ã¾ãã‚“ã¨ã€‡ã€‡è¨ºæ–­</title>
  <style>
    body {
      font-family: "Yu Gothic", sans-serif;
      text-align: center;
      background: #fff0f5;
      padding: 40px;
      overflow: hidden;
    }

    h1 {
      color: #ff4081;
      margin-bottom: 20px;
      position: relative;
      z-index: 2;
    }

    .input-area {
      position: relative;
      display: inline-block;
      margin-bottom: 20px;
    }

    input {
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      z-index: 2;
      position: relative;
    }

    button {
      padding: 12px 24px;
      font-size: 18px;
      border: none;
      background: #ff80ab;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      z-index: 2;
      position: relative;
      margin-top: 10px;
    }

    button:hover {
      background: #ff4081;
    }

    #result {
      font-size: 28px;
      margin-top: 40px;
      margin-bottom: 15px;
      z-index: 2;
      position: relative;
      opacity: 0;
    }

    #fantasy {
      font-size: 20px;
      white-space: pre-line;
      line-height: 1.8;
      max-width: 600px;
      margin: 0 auto;
      z-index: 2;
      position: relative;
      opacity: 0;
    }

    /* ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .fade-in {
      animation: fadeIn 1s ease forwards;
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    /* é£¾ã‚Šã®æ˜Ÿãƒ»ã²ã¾ã‚ã‚Š */
    .floating {
      position: absolute;
      animation: floatAround 6s infinite ease-in-out alternate;
      pointer-events: none;
      font-size: 24px;
      opacity: 0.8;
    }

    @keyframes floatAround {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(-20px) rotate(360deg); }
    }

    /* ãƒãƒ¼ãƒˆ */
    .heart {
      position: absolute;
      font-size: 24px;
      opacity: 0.7;
      animation: floatUp linear forwards;
      pointer-events: none;
    }

    @keyframes floatUp {
      0% {
        transform: translateY(0) scale(1);
        opacity: 0.8;
      }
      100% {
        transform: translateY(-120vh) scale(1.5);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <h1>ãã†ã¾ãã‚“ã¨ã€‡ã€‡è¨ºæ–­</h1>

  <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ï¼ˆæ˜Ÿã¨ã²ã¾ã‚ã‚Šä»˜ãï¼‰ -->
  <div class="input-area">
    <input type="text" id="username" placeholder="åå‰ã‚’å…¥åŠ›ã—ã¦ã­">
    <div class="floating" style="top:-30px; left:-40px;">â­</div>
    <div class="floating" style="top:-20px; right:-40px;">ğŸŒ»</div>
    <div class="floating" style="bottom:-30px; left:-30px;">â­</div>
    <div class="floating" style="bottom:-20px; right:-30px;">ğŸŒ»</div>
  </div>
  <br>
  <button onclick="diagnose()">è¨ºæ–­ã™ã‚‹ï¼</button>

  <div id="result-area">
    <h2 id="result"></h2>
    <p id="fantasy"></p>
    <button id="retry" style="display:none;" onclick="retry()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
  </div>

  <script>
    const results = [
      { title: "ãã†ã¾ãã‚“ã¨ã‚²ãƒ¼ãƒ ã™ã‚‹ï¼", text: "å‹è² ã«è² ã‘ã¦æ‹—ã­ã¦ã„ãŸã‚‰ã€ãã†ã¾ãã‚“ãŒé ­ã‚’ã½ã‚“ã£ã¨æ’«ã§ã¦ããŸã€‚\nã€æ¬¡ã¯æœ¬æ°—å‡ºã—ã¦ã„ã„ï¼Ÿã€ã£ã¦æŒ‘ç™ºã™ã‚‹ã¿ãŸã„ã«ç¬‘ã†é¡”ãŒè¿‘ã„ã€‚\nè¦–ç·šã‚’é€¸ã‚‰ã—ãŸã®ã«ã€é¼“å‹•ã®é€Ÿã•ã¾ã§ã¯éš ã›ãªã‹ã£ãŸã€‚", type: "dokidoki" },
      { title: "ãã†ã¾ãã‚“ã¨æ˜ ç”»ã‚’è¦‹ã‚‹ï¼", text: "æš—ã„é¤¨å†…ã§ã“ã£ãã‚Šæ¨ªé¡”ã‚’ç›—ã¿è¦‹ãŸã€‚\nã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã®å…‰ã«ç…§ã‚‰ã•ã‚Œã¦ã€è¦–ç·šãŒä¸€ç¬ã ã‘é‡ãªã‚‹ã€‚\nã€ãªã«ï¼Ÿã€ã¨å›ã‹ã‚Œã¦ã€å¿ƒè‡“ãŒå‹æ‰‹ã«è·³ã­ä¸ŠãŒã£ãŸã€‚", type: "seishun" },
      // ...ï¼ˆ20å€‹ã™ã¹ã¦ï¼‰
    ];

    function generateIndex(name, max) {
      const today = new Date();
      const dateStr = today.getFullYear() + "-" + (today.getMonth()+1) + "-" + today.getDate();
      const key = name + dateStr;

      let hash = 0;
      for (let i = 0; i < key.length; i++) {
        hash = (hash << 5) - hash + key.charCodeAt(i);
        hash |= 0;
      }
      return Math.abs(hash) % max;
    }

    function diagnose() {
      const name = document.getElementById("username").value.trim();
      if (!name) {
        alert("åå‰ã‚’å…¥åŠ›ã—ã¦ã­ï¼");
        return;
      }

      const index = generateIndex(name, results.length);
      const result = results[index];

      const resultEl = document.getElementById("result");
      const fantasyEl = document.getElementById("fantasy");

      resultEl.innerText = `${name}ã•ã‚“ã®ä»Šæ—¥ã®è¨ºæ–­ã¯â€¦\n${result.title}`;
      fantasyEl.innerText = result.text;

      if (result.type === "dokidoki") {
        fantasyEl.style.color = "#e91e63";
      } else {
        fantasyEl.style.color = "#3f51b5";
      }

      // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ç›´ã™
      resultEl.classList.remove("fade-in");
      fantasyEl.classList.remove("fade-in");
      void resultEl.offsetWidth; // å†é©ç”¨ç”¨
      resultEl.classList.add("fade-in");
      fantasyEl.classList.add("fade-in");

      document.getElementById("retry").style.display = "inline-block";

      // ğŸ’–è¨ºæ–­æ™‚ã«ãƒãƒ¼ãƒˆã‚’å¤§é‡ç”Ÿæˆ
      for (let i = 0; i < 20; i++) {
        setTimeout(createHeart, i * 200);
      }
    }

    function retry() {
      diagnose();
    }

    function createHeart() {
      const heart = document.createElement("div");
      heart.classList.add("heart");
      heart.innerText = "ğŸ’–";

      heart.style.left = Math.random() * 100 + "vw";
      heart.style.fontSize = (20 + Math.random() * 30) + "px";
      heart.style.animationDuration = (3 + Math.random() * 3) + "s";

      document.body.appendChild(heart);

      setTimeout(() => {
        heart.remove();
      }, 7000);
    }
  </script>
</body>
</html>
